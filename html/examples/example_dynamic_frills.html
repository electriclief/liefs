<!-- Note: All elements (Divs) that are to be use by liefs MUST be defined.
  For example, if you have:
  <div id="idNotUsed"></div>
  liefs will ignore this element, and it will sit on top/bottom VISIBLE!!! - Not handled by liefs at all
  This will look horrible.  Simply having the line:
  I("idNotUsed","100%"); // Now liefs knows to set this to visible=flase, and hides till you need it.
-->
<!DOCTYPE html>                                       <!-- Hey, Wheres the 10 page css file? Inline Only! Wow -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="/js/basic1.js"></script>                   <!-- this is the REQUIRED CODE for liefs to work! -->
    <title>Example Dynamic Layout</title>
</head>
<style>div {border-style: solid;border-width: 1px}</style>                               <!-- style to taste -->
<body style="background-color: violet"><!--females feel my colour schemes are a touch strong-men think they are fine-->

<div id="Header" style="background-color: lightgreen">100px High, Full Width</div> <!-- Used On Both Layouts -->

<div id="ListTree" style="background-color: lightcyan">
    <button onclick='switchTo("Page1");'>Page1</button><br>                      <!-- use ANY onclick element -->
    <button onclick='switchTo("Page2");'>Page2</button><br>                          <!-- concept page only - -->
    <button onclick='switchTo("Page3");'>Page3</button><br><!--Good, ole dependable button. Nothin beats button-->
    <button onclick='switchTo("Page4");'>Page4</button><br>
    <button onclick='window.location="/index.html"'>(link) Docs</button><br><br>
    <button onclick='myUse("Small")'>Force Small</button><br></div>           <!-- Used Only on Large Layout -->

<div id="SelectTree" style="background-color: lightcyan">
    <select style="width:100%;height:100%;background-color:#c6ffb2;font-size: 150%"
      onchange="onSelectChange(this.value)"><!-- Select Events are handled in our custom function below on this page-->
        <option value="Page1">Page 1</option>
        <option value="Page2">Page 2</option>
        <option value="Page3">Page 3</option>              <!--Good, ole dependable select. Nothin beats select-->
        <option value="Page4">Page 4</option>
        <option value="/index.html">(link) Docs</option>
        <option value="Large">Force Large</option>
    </select></div>                                                           <!-- Used Only On Small Layout -->

<div id="Page1" style="background-color: lightblue">                    <!-- Obviously put ANYTHING in a div -->
    Page 1 Content - Resize Page Width <-- this way --> to switch layouts<br><br>
    <span style="color:red;font-size: 200%">Frills Version!</span><br><br>
    Watch Page Title, Page Url Change and Pushed to Browser Stack<br>Back button works now<br>
    reload now reloads "this page" not the "first page|<br>
</div> <!-- Default Page -->

<div id="Page2" style="background-color: lightsteelblue">
    Page 2 Content - Resize Page Width <-- this way --> to switch layouts
</div>

<div id="Page3" style="background-color: aliceblue">
    Page 3 Content - Resize Page Width <-- this way --> to switch layouts
</div>

<div id="Page4" style="background-color: powderblue">
    Page 4 Content - Resize Page Width <-- this way --> to switch layouts
</div>

</body>
</html>
<script>
    var currentId; // lets remember the last Page Div Id Clicked
    function myUse(size) {use(size + "_" + currentId);resize_callback([winW, winH]);} // this is silly notation will fix
    // winW and winH are last screen width and height, trigger callback after use set
    function onSelectChange(value) {  // our custom handler for 3 types of choices
        if (value[0] === '/')                                 window.location = value;// start of / - link
        else if (containers["_Small_" + value] !== undefined) switchTo(value);        // Defined as Container - Switch
        else                                                  myUse(value);           // Assume "Set Active Container to"
    }
    function defineLayout(id) {             // Call this function for each page you have (See Below)
        V("Large_" + id,                    // our big layout consists of
                I("Header", "100px"),       // a header on top with Tree and Page below
                h("Body", "100%",
                        I("ListTree", "250px"),  // Tree on the left,
                        I(id, "100%")            // Body on the right.
                )
        );
        V("Small_" + id,                    // In small, no room for tree on left
                items['Header'],            // Note: If header changes size, use I("Header", newsize)
                I("SelectTree", "50px"),     //
                items[id]                   // Small all three stacked in one column.
        );
    }
    function setPage(id) {          // Custom Function to Set Page
        ManageArray = [             // ManageArray Set, so it governs
            ["Small_" + id, 800],     // Use "One Big Column" if screen width < 800px
            ["Large_" + id]           // Otherwise use Large Layout
        ];
    }
    function myPageTitle(id) {return "My Title - " + id} // Edit to suit

    function myIndexOf(string, search, occurance, start) { if (occurance) {start = string.indexOf(search, start) + 1;
        --occurance;if (occurance) return myIndexOf(string.slice(start), search, occurance, start); else
            return string.slice(start);} else return string;
    } // This is similar to pure javascript indexOf, I just added an occurance field, So:
      // myindexOf("http://somesite.domain/I/want/this.html","/",3,0); // return the 3rd occurance of "/" onward
      // return value: I/want/this.html

    function switchTo(id) {  // To make things work, lets build our own custom switch function
        currentId = id;      // make the CurrentId, the one we switched to
        setPage(id);         // see 7 lines up
        checkWinWH();        // triggers resize event

        var displayUrl = thisUrl;                                 // This Part of the functions just tells the browser
        var temp = thisUrl.indexOf("#");                          // We are faking a new page (tee hee still this one)
        if (temp !== -1) {                                        // and to push it to the stack
            displayUrl = thisUrl.slice(0, thisUrl.indexOf("#"));  // Its just for "Frills"
        }                                                         // and is not at all required
        document.title = myPageTitle(id);                         // for functionality
        window.history.pushState({"html": "#" + id, "pageTitle": myPageTitle(id)}, "", displayUrl + "#" + id);
    }

    window.onpopstate = function (e) { // "When you hit the 'back' button on browser
        if (e.state) {                 // and somehow I'm still on this page, and not elsewhere
            if (e.state.html[0] = "#") { // check to see if previous address had a # in the title
                currentId = e.state.html.slice(1);setPage(currentId);checkWinWH(); // and set page to that one
                document.title = myPageTitle(currentId);                           // with matching title
                checkWinWH();                                                      // and trigger refresh
            }
        }
    };
    var thisUrl = "/"+myIndexOf(window.location.href, "/", 2, 0);
//    waitForIt(function () {return window['loadsDone']}, function () {// If Items defined in urlload un-comment this//
    window.onload = function () {                                                                                    //
        marginDefault = 20; // Margins 4 work well, Margins 0 be CRAZY be carefull with css - can mess things up     //
        for (var eachPage of ['Page1', 'Page2', 'Page3', 'Page4']) defineLayout(eachPage); // see 26 lines up        //
        // by defining all divs in above line, liefs knows to set visibility properly                                //
        // If you add pages, be sure to add the id to the above "for loop" array                                     //
                                                                                                                     //
        use("Large_Page1"); //  (will change higher version) needed, then ignored - pick any existing CONTAINER      //
        switchTo('Page1');  //   I'm hoping my function name and arguments aren't too confusing here....             //
        startHandler();     //   Guess what this does!                                                               //
        if (thisUrl.indexOf("#") !== -1 ){switchTo(thisUrl.slice(thisUrl.indexOf("#")+1));}                          //
        // Above line is "if url has #, switch to that page                                                          //
    };                                                                                                               //
//    });                                                                                           // ...And This...//
</script>


